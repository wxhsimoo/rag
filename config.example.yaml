# 婴幼儿营养RAG系统配置文件示例
# 复制此文件为 config.yaml 并根据实际情况修改配置

# 应用基础配置
app:
  name: "婴幼儿营养RAG系统"
  version: "1.0.0"
  environment: "development"  # development, staging, production
  debug: true
  log_level: "INFO"  # DEBUG, INFO, WARNING, ERROR

# 服务器配置
server:
  host: "0.0.0.0"
  port: 8000
  reload: true  # 开发环境自动重载
  workers: 1    # 生产环境可增加worker数量

# 数据存储配置
storage:
  # 向量数据库配置
  vector_store:
    type: "faiss"  # faiss, chroma, pinecone

    faiss:
      dimension: 384  # 嵌入向量维度
      index_path: "./data/vector_index"
    
  # 本地文件存储
  documents:
    type: "local"  # 本地 / 云存储 / DB

    local:
      base_path: "./data/storage"
      max_file_size_mb: 10
      documents_path: "./data"

# AI服务提供商配置
ai_providers:
  # 嵌入模型配置
  embedding:
    provider: "sentence_transformers"  # openai, aliyun, sentence_transformers
    batch_size: 32
    max_length: 512
    
    # OpenAI嵌入配置
    openai:
      api_key: "your-openai-api-key-here"
      model: "text-embedding-ada-002"
      api_base: "https://api.openai.com/v1"
      
    # 阿里云嵌入配置
    aliyun:
      api_key: "your-aliyun-api-key-here"
      model: "text-embedding-v1"  # 轻量级中文支持模型
      api_base: "https://dashscope.aliyuncs.com/api/v1"
      
    # SentenceTransformers配置
    sentence_transformers:
      model: "all-MiniLM-L6-v2"  # 或 "paraphrase-multilingual-MiniLM-L12-v2" 多语言模型
      device: "cpu"  # cpu 或 cuda
      
  # 大语言模型配置
  llm:
    provider: "openai"  # openai, aliyun, anthropic, local
    max_tokens: 1000
    temperature: 0.7
    
    # OpenAI配置
    openai:
      api_key: "your-openai-api-key-here"
      model: "gpt-3.5-turbo"
      api_base: "https://api.openai.com/v1"
      organization: "your-org-id"  # 可选
      
    # 阿里云LLM配置
    aliyun:
      api_key: "your-aliyun-api-key-here"
      model: "qwen-turbo"
      api_base: "https://dashscope.aliyuncs.com/api/v1"
      
    # Anthropic配置（如果使用Claude）
    anthropic:
      api_key: "your-anthropic-api-key-here"
      model: "claude-3-sonnet-20240229"
      
    # 本地模型配置（如果使用本地模型）
    local:
      model_path: "./models/local-llm"
      device: "cpu"  # cpu, cuda

# RAG系统配置
rag:
  # 检索配置
  retrieval:
    top_k: 5  # 检索的文档数量
    similarity_threshold: 0.7  # 相似度阈值
    max_context_length: 2000  # 最大上下文长度
    
  # 文档处理配置
  document_processing:
    chunk_size: 500  # 文档分块大小
    chunk_overlap: 50  # 分块重叠大小
    supported_formats: ["txt", "md", "json"]
    
  # 对话配置
  conversation:
    max_history_length: 10  # 最大对话历史长度
    session_timeout_minutes: 30  # 会话超时时间
    
# 营养规则引擎配置
nutrition_rules:
  # 默认规则配置
  default_rules_enabled: true
  
  # 年龄相关规则
  age_rules:
    strict_mode: true  # 严格模式，严格按年龄限制
    
  # 过敏原规则
  allergy_rules:
    severity_levels: ["mild", "moderate", "severe"]
    default_severity: "moderate"
    
  # 营养需求规则
  nutrition_requirements:
    iron_focus_age_months: 6  # 重点关注铁质的年龄
    calcium_focus_age_months: 8  # 重点关注钙质的年龄

# 食物推荐配置
food_recommendation:
  # 推荐算法配置
  algorithm:
    weight_relevance: 0.4  # 相关性权重
    weight_safety: 0.3     # 安全性权重
    weight_nutrition: 0.2  # 营养价值权重
    weight_age_suitability: 0.1  # 年龄适宜性权重
    
  # 推荐结果配置
  results:
    max_recommendations: 10  # 最大推荐数量
    min_score: 0.5          # 最低推荐分数
    diversity_factor: 0.8   # 多样性因子

# 缓存配置
cache:
  # 嵌入缓存
  embedding_cache:
    enabled: true
    max_size: 1000  # 最大缓存条目数
    ttl_seconds: 3600  # 缓存过期时间
    
  # 查询结果缓存
  query_cache:
    enabled: true
    max_size: 500
    ttl_seconds: 1800

# 监控和日志配置
monitoring:
  # 性能监控
  performance:
    enabled: true
    slow_query_threshold_ms: 1000  # 慢查询阈值
    
  # 健康检查
  health_check:
    enabled: true
    interval_seconds: 60
    
  # 指标收集
  metrics:
    enabled: true
    export_port: 9090

# 安全配置
security:
  # CORS配置
  cors:
    allow_origins: ["*"]  # 生产环境应限制具体域名
    allow_methods: ["GET", "POST", "PUT", "DELETE"]
    allow_headers: ["*"]
    
  # API限流
  rate_limiting:
    enabled: true
    requests_per_minute: 60
    
  # API密钥（可选）
  api_key:
    enabled: false
    key: "your-api-key-here"

# 开发配置
development:
  # 自动重载
  auto_reload: true
  
  # 调试模式
  debug_mode: true
  
  # 测试数据
  use_sample_data: true
  sample_data_path: "./data/samples"
  
  # 模拟模式（不调用真实AI服务）
  mock_ai_services: false

# 生产环境配置
production:
  # 性能优化
  optimization:
    enable_compression: true
    enable_caching: true
    
  # 安全加固
  security:
    hide_server_header: true
    enable_https_redirect: true
    
  # 日志配置
  logging:
    level: "WARNING"
    file_path: "/var/log/rag-system.log"
    max_file_size_mb: 100
    backup_count: 5